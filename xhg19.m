function [x,x1]=xhg19(a,p,opt)
if (nargin<3)
    opt='hg19';
end
if (nargin<2)
    p=[];
end
% conver chom number a and position p to linear base number from 1 to 3e9
 L=[249250621;... % 1 	
	243199373;	... % 2
	198022430; ...  % 3 
	191154276; ...  % 4 
	180915260; ...  % 5 
	171115067; ...  % 6 
	159138663; ...  % 7 
	146364022; ...  % 8 
	141213431; ...  % 9
	135534747; ...  % 10 
	135006516; ...  % 11
	133851895; ...  % 12
	115169878; ...  % 13
	107349540; ...  % 14
	102531392; ...  % 15
	90354753; ...  % 16
	81195210; ...  % 17
	78077248; ...  % 18
	59128983; ...  % 19
	63025520; ...  % 20
	48129895; ...  % 21
	51304566; ...  % 22
	155270560; ... % X
	59373566; ...  % Y
	16569];  	   % MT 
%mysql --user=genome --host=genome-mysql.cse.ucsc.edu -A -e "select chrom, size from hg18.chromInfo" | grep -v ^chrom |  grep -v rand  | grep -v hap

L18=[247249719,...%	1
    242951149,... %	2
    199501827,... %	3
    191273063,... %	4
    180857866,... %	5
    170899992,... %	6
    158821424,... %	7
    146274826,... %	8
    140273252,... %	9
    135374737,... %	10
    134452384,... %	11
    132349534,... %	12
    114142980,... %	13
    106368585,... %	14
    100338915,... %	15
    88827254,... %	16
    78774742,... %	17
    76117153,... %	18
    63811651,... %	19
    62435964,... %	20
    46944323,... %	21
    49691432,... %	22
    154913754,... %	X
    57772954,... %	Y
    16571]'; %	MT

Lmm9=[197195432, ... %chr1	197195432
181748087, ... %chr2	181748087
159599783, ... %chr3	159599783
155630120, ... %chr4	155630120
152537259, ... %chr5	152537259
149517037, ... %chr6	149517037
152524553, ... %chr7	152524553
131738871, ... %chr8	131738871
124076172, ... %chr9	124076172
129993255, ... %chr10	129993255
121843856, ... %chr11	121843856
121257530, ... %chr12	121257530
120284312, ... %chr13	120284312
125194864, ... %chr14	125194864
103494974, ... %chr15	103494974
98319150, ... %chr16	98319150
95272651, ... %chr17	95272651
90772031, ... %chr18	90772031
61342430, ... %chr19	61342430
0, ... %no chr20	
0, ... %no chr21	
0, ... %no chr22	
166650296, ... %chrX	166650296
15902555, ... %chrY	15902555
16299]'; ... %chrM	16299

if (strcmpi(opt,'HG18')|~isempty(strmatch(opt,'36')))
    L=L18;
end
if (strcmpi(opt,'mm9')|~isempty(strmatch(opt,'36')))
    L=Lmm9;
end



PAD=0;
if (strcmpi(opt,'pad'))
    PAD=10e6;
    L=L+PAD;
end

C=[1; cumsum(L)];
s=size(a);
if (s(2)==1)
    C=C(:);
else
    C=C(:)';
end    

if ~isnumeric(a)
    a=regexprep(a,'^M$','MT'); 
    a=chrom2num(a);
end
if ~isempty(p)     
    if ~isa(p(1),'double')
        p=double(p);
    end
    if ~isa(a(1),'double')
        a=double(a);
    end
    x=0*a; k=find(a>0); 
    x(k)=C(a(k))+p(k);
    x1=C;
else
    % invert linear coord back to hg19 (a,p) pair
    [q,x] = histc(a,C);
    x1=a-C(x);
end



    
